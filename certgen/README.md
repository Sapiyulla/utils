# Certificate Generator Utility (`certgen`)

Утилита для генерации TLS/SSL сертификатов (CA, серверных и клиентских) с поддержкой mutual TLS (mTLS)

## Оглавление

- [Возможности](#возможности)
- [Установка](#установка)
- [Использование](#использование)
  - [Полная генерация сертификатов](#полная-генерация-сертификатов)
  - [Генерация нового клиентского сертификата](#генерация-нового-клиентского-сертификата)
- [Структура файлов](#структура-файлов)
- [Примеры](#примеры)
- [Ограничения](#ограничения)

## Возможности

- Генерация корневого сертификата (CA)
- Создание серверных сертификатов для localhost
- Поддержка mutual TLS (клиентские сертификаты)
- Гибкая система именования файлов
- Автоматическое определение пути сохранения
- Логирование путей к созданным файлам

## Установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/Sapiyulla/utils/certgen.git
cd certgen
```

2. Соберите утилиту:
```bash
go build -o certgen
```

3. (Опционально) Добавьте в PATH:
```bash
sudo mv certgen /usr/local/bin/
```

## Использование

### Полная генерация сертификатов

Базовый синтаксис:
```bash
./certgen [--mutual] [--out-path PATH]
```

Флаги:
- `--mutual` - генерировать клиентские сертификаты для mTLS
- `--out-path` - путь для сохранения (по умолчанию `certs`)

### Генерация нового клиентского сертификата

Базовый синтаксис:
```bash
./certgen -new [--key-name NAME] [--crt-name NAME]
```

Флаги:
- `-new` - режим генерации нового клиентского сертификата
- `--key-name` - имя для файла ключа (без расширения)
- `--crt-name` - имя для файла сертификата (без расширения)

## Структура файлов

При полной генерации создается следующая структура:

```
[out-path]/
├── ca/
│   ├── ca.crt
│   └── ca.key
├── servers/
│   ├── server.crt
│   └── server.key
└── clients/
    ├── client.crt  # только с --mutual
    └── client.key  # только с --mutual
```

В режиме `-new` файлы сохраняются в `[out-path]/clients/`

## Примеры

1. Стандартная генерация:
```bash
./certgen
```
Создаст CA, серверные сертификаты в `certs/`

2. Генерация с mTLS:
```bash
./certgen --mutual --out-path secure-certs
```
Дополнительно создаст клиентские сертификаты в `secure-certs/`

3. Генерация в текущую папку:
```bash
mkdir certs
cd certs
../certgen
```
Или явно:
```bash
./certgen --out-path .
```

4. Создание нового клиентского сертификата:
```bash
./certgen -new --key-name mobile-app --crt-name mobile-client
```
Создаст `mobile-client.crt` и `mobile-app.key` в `certs/clients/`

5. Быстрое создание клиентского сертификата:
```bash
./certgen -new
```
Создаст `newClient.crt` и `newClient.key`

## Ограничения

1. Для генерации новых клиентских сертификатов (`-new`) должны существовать:
   - `ca/ca.crt`
   - `ca/ca.key`

2. Имена файлов:
   - Не должны содержать расширений при указании через флаги
   - Должны быть валидными для файловой системы

3. Поддерживается только RSA 4096 бит

4. Сертификаты генерируются сроком на 1 год

---

**Лицензия**: MIT  
**Поддержка**: Для сообщений о проблемах используйте Issues в GitHub